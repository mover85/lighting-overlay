{"mappings":"oeAAAA,EAAA,SAAAC,SAA8CC,KAAKC,MAAM,+GCAzD,IAAAC,EAAAJ,EAAA,S,mEASA,MAAMK,EAA0BC,IAC9B,MAAMC,EAASC,OAAOC,iBAAiBH,GACjCI,EAAUC,WAAWJ,EAAOK,aAAeD,WAAWJ,EAAOM,cACnE,OAAOP,EAAQQ,YAAcJ,CAAO,E,MCZtCK,EAAiB,IAAAC,IAAoBhB,EAAA,SAAAiB,QAA6C,SAAQC,OAAAC,KAAAC,KAAEC,WDmB5F,MAiNMC,GAAoB,EAAAC,EAAAC,YAjNP,KACjB,MAAOC,IAAc,EAAAC,EAAAC,cAAa,aAAc,CAC9CC,OAAQ,GACRC,MAAO,GACPC,OAAQ,GACRC,MAAO,MAEHF,MACJA,EAAKC,OACLA,EAAMC,MACNA,EAAKH,OACLA,GACEH,GACGO,IAAqB,EAAAN,EAAAC,cAAa,qBAAqB,GAExDM,GAAK,EAAAV,EAAAW,QAAOC,EAAAC,QAAKC,YACjBC,GAAY,EAAAf,EAAAW,SAAO,EAAAK,EAAAC,cACnBC,GAAQ,EAAAlB,EAAAW,SAAO,EAAAK,EAAAC,cACfE,GAAS,EAAAnB,EAAAW,SAAO,EAAAK,EAAAC,eAEtB,EAAAjB,EAAAoB,YAAU,KACR,MAAMC,EAAUN,EAAUO,QAAQC,MAAMC,cAAc,UAChDC,EAAaJ,EAAQK,YACrBC,EAAW7C,EAAuBiC,EAAUO,QAAQC,OACtDE,EAAaE,EACff,EAAAC,QAAKe,IAAIP,EAAS,CAAEQ,OAAQF,EAAWF,IAEvCb,EAAAC,QAAKe,IAAIP,EAAS,CAAEQ,OAAQ,GAAI,GAEjC,CAACvB,KAEJ,EAAAN,EAAAoB,YAAU,KACR,MAAMU,EAAWf,EAAUO,QAAQC,MAAMC,cAAc,WACjDO,EAAcD,EAASJ,YACvBC,EAAW7C,EAAuBiC,EAAUO,QAAQC,OACtDQ,EAAcJ,EAChBf,EAAAC,QAAKe,IAAIE,EAAU,CAAED,OAAQF,EAAWI,IAExCnB,EAAAC,QAAKe,IAAIE,EAAU,CAAED,OAAQ,GAAI,GAElC,CAACtB,KAEJ,EAAAP,EAAAoB,YAAU,KACR,MAAMY,EAAUjB,EAAUO,QAAQC,MAAMC,cAAc,UAChDS,EAAaD,EAAQN,YACrBC,EAAW7C,EAAuBiC,EAAUO,QAAQC,OACtDU,EAAaN,EACff,EAAAC,QAAKe,IAAII,EAAS,CAAEH,OAAQF,EAAWM,IAEvCrB,EAAAC,QAAKe,IAAII,EAAS,CAAEH,OAAQ,GAAI,GAEjC,CAACrB,IAEJ,MAAM0B,GAAO,EAAAlC,EAAAmC,cAAY,KAEvBzB,EAAGY,QAAQc,GAAG,GAAI,IAAM,IAExB1B,EAAGY,QAAQc,GAAGjB,EAAOG,QAAQC,MAAO,CAClCc,SAAU,GACVC,OAAQ,OACRC,KAAM,qBAGR7B,EAAGY,QAAQkB,IAAI,WAEf9B,EAAGY,QAAQc,GAAGlB,EAAMI,QAAQC,MAAO,CACjCc,SAAU,GACVI,EAAG,KACHF,KAAM,kBACL,WAEH7B,EAAGY,QAAQc,GAAGrB,EAAUO,QAAQC,MAAO,CACrCc,SAAU,GACVI,EAAG,KACHF,KAAM,kBACL,UAAU,GACZ,IAEGG,GAAO,EAAA1C,EAAAmC,cAAY,KACvBzB,EAAGY,QAAQkB,IAAI,YAEf9B,EAAGY,QAAQc,GAAGlB,EAAMI,QAAQC,MAAO,CACjCc,SAAU,GACVI,EAAG,OACHF,KAAM,iBACL,iBAEH7B,EAAGY,QAAQc,GAAGrB,EAAUO,QAAQC,MAAO,CACrCc,SAAU,GACVI,EAAG,QACHF,KAAM,iBACL,YAEH7B,EAAGY,QAAQc,GAAGjB,EAAOG,QAAQC,MAAO,CAClCc,SAAU,GACVC,OAAQ,KACRC,KAAM,oBACN,GACD,IAUH,OARA,EAAAvC,EAAAoB,YAAU,KACJX,EACFyB,IAEAQ,GAAM,GAEP,CAACjC,EAAmByB,EAAMQ,IAEtB7D,EAAA8D,IAAI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eA8EEtC;uBACM,IAAAZ,IAAAD;;;WAGX,EAAAwB,EAAA4B,KAAI1B,EAAMI;;;;;2BAKM,EAAAN,EAAA4B,KAAIzB,EAAOG;;;oDAGc,EAAAN,EAAA4B,KAAI7B,EAAUO;;qCAE5BhB;8BACPC;6BACDC;;;;GAI1B,IAKHqC,eAAeC,OAAO,qBAAsB/C","sources":["node_modules/@parcel/runtime-js/lib/runtime-72be4ffca73f8c8d.js","src/graphics/elements/nowplaying/nowplaying.js","node_modules/@parcel/runtime-js/lib/runtime-0811eeb61865838f.js"],"sourcesContent":["require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"1iOMD\\\":\\\"index.0a8ab18d.js\\\",\\\"c0VRY\\\":\\\"default_album_cover.b902dc0a.jpg\\\"}\"));","import { html } from 'lit';\nimport gsap from 'gsap';\nimport { createRef, ref } from 'lit/directives/ref';\nimport '@polymer/iron-image';\nimport {\n  component, useCallback, useEffect, useRef,\n} from 'haunted';\nimport { useReplicant } from '../../../hooks/use-replicant';\n\nconst getElementContentWidth = (element) => {\n  const styles = window.getComputedStyle(element);\n  const padding = parseFloat(styles.paddingLeft) + parseFloat(styles.paddingRight);\n  return element.clientWidth - padding;\n};\n\n/**\n * @customElement\n * @polymer\n */\nconst Nowplaying = () => {\n  const [nowPlaying] = useReplicant('nowPlaying', {\n    artUrl: '',\n    title: '',\n    artist: '',\n    album: '',\n  });\n  const {\n    title,\n    artist,\n    album,\n    artUrl,\n  } = nowPlaying;\n  const [nowPlayingShowing] = useReplicant('nowPlayingShowing', false);\n\n  const tl = useRef(gsap.timeline());\n  const detailsEl = useRef(createRef());\n  const artEl = useRef(createRef());\n  const lineEl = useRef(createRef());\n\n  useEffect(() => {\n    const titleEl = detailsEl.current.value.querySelector('.title');\n    const titleWidth = titleEl.scrollWidth;\n    const maxWidth = getElementContentWidth(detailsEl.current.value);\n    if (titleWidth > maxWidth) {\n      gsap.set(titleEl, { scaleX: maxWidth / titleWidth });\n    } else {\n      gsap.set(titleEl, { scaleX: 1 });\n    }\n  }, [title]);\n\n  useEffect(() => {\n    const artistEl = detailsEl.current.value.querySelector('.artist');\n    const artistWidth = artistEl.scrollWidth;\n    const maxWidth = getElementContentWidth(detailsEl.current.value);\n    if (artistWidth > maxWidth) {\n      gsap.set(artistEl, { scaleX: maxWidth / artistWidth });\n    } else {\n      gsap.set(artistEl, { scaleX: 1 });\n    }\n  }, [artist]);\n\n  useEffect(() => {\n    const albumEl = detailsEl.current.value.querySelector('.album');\n    const albumWidth = albumEl.scrollWidth;\n    const maxWidth = getElementContentWidth(detailsEl.current.value);\n    if (albumWidth > maxWidth) {\n      gsap.set(albumEl, { scaleX: maxWidth / albumWidth });\n    } else {\n      gsap.set(albumEl, { scaleX: 1 });\n    }\n  }, [album]);\n\n  const show = useCallback(() => {\n    // Prevent first \"call\" from getting ignored\n    tl.current.to({}, 0.01, { });\n\n    tl.current.to(lineEl.current.value, {\n      duration: 0.5,\n      height: '100%',\n      ease: 'Power1.easeInOut',\n    });\n\n    tl.current.add('stuffIn');\n\n    tl.current.to(artEl.current.value, {\n      duration: 0.4,\n      x: '0%',\n      ease: 'Power1.easeOut',\n    }, 'stuffIn');\n\n    tl.current.to(detailsEl.current.value, {\n      duration: 0.7,\n      x: '0%',\n      ease: 'Power1.easeOut',\n    }, 'stuffIn');\n  }, []);\n\n  const hide = useCallback(() => {\n    tl.current.add('stuffOut');\n\n    tl.current.to(artEl.current.value, {\n      duration: 0.4,\n      x: '100%',\n      ease: 'Power1.easeIn',\n    }, 'stuffOut+=0.3');\n\n    tl.current.to(detailsEl.current.value, {\n      duration: 0.7,\n      x: '-100%',\n      ease: 'Power1.easeIn',\n    }, 'stuffOut');\n\n    tl.current.to(lineEl.current.value, {\n      duration: 0.5,\n      height: '0%',\n      ease: 'Power1.easeInOut',\n    });\n  }, []);\n\n  useEffect(() => {\n    if (nowPlayingShowing) {\n      show();\n    } else {\n      hide();\n    }\n  }, [nowPlayingShowing, show, hide]);\n\n  return html`\n    <style>\n      :host {\n        display: flex;\n        position: absolute;\n        bottom: 88px;\n        left: 88px;\n      }\n\n      .fullHeight {\n        height: 120px;\n      }\n\n      .cull {\n        overflow: hidden;\n      }\n\n      .centerFlex {\n        display: flex;\n        align-items: center;\n      }\n\n      .background {\n        background-color: rgba(0, 0, 0, 0.75);\n      }\n\n      .art {\n        width: 120px;\n        background-position: center;\n        background-size: contain;\n        background-color: #D3C9C9;\n        transform: translateX(100%);\n      }\n\n      .line {\n        width: 3px;\n        height: 0;\n        background-color: #ac09ff;\n      }\n\n      .details {\n        display: flex;\n        flex-direction: column;\n        padding: 1.2em 2em 1em 1em;\n        color: #E4E4E4;\n        white-space: nowrap;\n        max-width: 500px;\n        box-sizing: border-box;\n        transform: translateX(-100%);\n      }\n\n      .title {\n        font-size: 30px;\n        line-height: 34px;\n        transform-origin: left;\n        font-weight: 600;\n        margin: 0 0 0.25em 0;\n      }\n\n      .artist {\n        font-size: 20px;\n        line-height: 22px;\n        transform-origin: left;\n        margin: 0 0 0.25em 0;\n      }\n\n      .album {\n        font-size: 18px;\n        line-height: 22px;\n        transform-origin: left;\n        margin: 0;\n      }\n    </style>\n\n    <div class=\"cull fullHeight\">\n      <iron-image\n        class=\"art fullHeight\"\n        sizing=\"contain\"\n        src=\"${artUrl}\"\n        placeholder=\"${new URL('./img/default_album_cover.jpg', import.meta.url)}\"\n        preload\n        fade\n        ${ref(artEl.current)}\n      >\n      </iron-image>\n    </div>\n    <div class=\"cull fullHeight centerFlex\">\n      <div class=\"line\" ${ref(lineEl.current)}></div>\n    </div>\n    <div class=\"cull\">\n      <div class=\"details background fullHeight\" ${ref(detailsEl.current)}>\n        <div>\n          <p class=\"title\">&#9834; ${title}</p>\n          <p class=\"artist\">${artist}</p>\n          <p class=\"album\">${album}</p>\n        </div>\n      </div>\n    </div>\n  `;\n};\n\nconst NowplayingElement = component(Nowplaying);\n\ncustomElements.define('element-nowplaying', NowplayingElement);\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"c0VRY\")).toString();"],"names":["parcelRequire","register","JSON","parse","$jJu03","$1d03665a30d6fac5$var$getElementContentWidth","element","styles","window","getComputedStyle","padding","parseFloat","paddingLeft","paddingRight","clientWidth","$4417fa1222541d51$exports","URL","resolve","import","meta","url","toString","$1d03665a30d6fac5$var$NowplayingElement","$hcek7","component","nowPlaying","$4gmId","useReplicant","artUrl","title","artist","album","nowPlayingShowing","tl","useRef","$4Dq4i","default","timeline","detailsEl","$ecxJc","createRef","artEl","lineEl","useEffect","titleEl","current","value","querySelector","titleWidth","scrollWidth","maxWidth","set","scaleX","artistEl","artistWidth","albumEl","albumWidth","show","useCallback","to","duration","height","ease","add","x","hide","html","ref","customElements","define"],"version":3,"file":"index.0a8ab18d.js.map"}